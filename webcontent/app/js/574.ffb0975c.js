"use strict";(self["webpackChunkapp"]=self["webpackChunkapp"]||[]).push([[574],{3828:(e,t,o)=>{o.d(t,{Z:()=>v});var s=o(9835),n=o(6970);const a=e=>((0,s.dD)("data-v-9fde52e0"),e=e(),(0,s.Cn)(),e),r={class:"text-h5"},l=a((()=>(0,s._)("div",null,null,-1)));function i(e,t,o,a,i,d){const m=(0,s.up)("pages-menu"),p=(0,s.up)("q-toolbar");return(0,s.wg)(),(0,s.j4)(p,{class:"title fit row wrap justify-between"},{default:(0,s.w5)((()=>[(0,s.Wm)(m,{active:o.active},null,8,["active"]),(0,s._)("div",r,(0,n.zw)(o.title),1),l])),_:1})}function d(e,t,o,a,r,l){const i=(0,s.up)("q-item-section"),d=(0,s.up)("q-item"),m=(0,s.up)("q-list"),p=(0,s.up)("q-menu"),c=(0,s.up)("q-btn");return(0,s.wg)(),(0,s.j4)(c,{color:"primary",round:"",icon:"menu"},{default:(0,s.w5)((()=>[(0,s.Wm)(p,{"transition-show":"scale","transition-hide":"scale"},{default:(0,s.w5)((()=>[(0,s.Wm)(m,{style:{"min-width":"100px"}},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(r.items,(e=>((0,s.wg)(),(0,s.j4)(d,{key:e.title,to:e.link,clickable:"",class:(0,n.C_)({activeitem:o.active===e.link})},{default:(0,s.w5)((()=>[(0,s.Wm)(i,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,n.zw)(e.title),1)])),_:2},1024)])),_:2},1032,["to","class"])))),128))])),_:1})])),_:1})])),_:1})}const m={name:"pages-menu",props:["active"],data(){return{items:[{title:"Overview",link:"/overview"},{title:"Metadata",link:"/model"},{title:"Diagrams",link:"/diagram"},{title:"Monitoring",link:"/monitoring"}]}},computed:{},methods:{},watch:{},async mounted(){}};var p=o(1639),c=o(4455),u=o(5290),w=o(3246),h=o(490),E=o(1233),g=o(9984),H=o.n(g);const G=(0,p.Z)(m,[["render",d],["__scopeId","data-v-0bf92e70"]]),k=G;H()(m,"components",{QBtn:c.Z,QMenu:u.Z,QList:w.Z,QItem:h.Z,QItemSection:E.Z});const _={name:"pages-toolbar",props:["title","active"],components:{pagesMenu:k},data(){return{}},computed:{},methods:{},watch:{},async mounted(){}};var f=o(1663);const b=(0,p.Z)(_,[["render",i],["__scopeId","data-v-9fde52e0"]]),v=b;H()(_,"components",{QToolbar:f.Z})},2574:(e,t,o)=>{o.r(t),o.d(t,{default:()=>S});var s=o(9835),n=o(6970);const a=(0,s.Uk)("refresh"),r={key:0},l={key:1},i={key:0,style:{color:"red"}};function d(e,t,o,d,m,p){const c=(0,s.up)("pages-toolbar"),u=(0,s.up)("q-header"),w=(0,s.up)("q-select"),h=(0,s.up)("q-toolbar"),E=(0,s.up)("q-btn"),g=(0,s.up)("q-td"),H=(0,s.up)("q-tr"),G=(0,s.up)("q-table"),k=(0,s.up)("q-page"),_=(0,s.up)("q-page-container"),f=(0,s.up)("q-layout");return(0,s.wg)(),(0,s.j4)(f,{view:"hHh LpR fFf"},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{reveal:"",elevated:"",class:"bg-grey-7 text-grey-4"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{title:"TubeDB monitoring",active:"/monitoring"})])),_:1}),(0,s.Wm)(_,{class:"row"},{default:(0,s.w5)((()=>[(0,s.Wm)(k,{padding:"",class:"column"},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{class:"shadow-2"},{default:(0,s.w5)((()=>[(0,s.Wm)(w,{outlined:"",label:"Select monitored set",options:["Exploratories HEG"],"stack-label":"",modelValue:m.selectedSet,"onUpdate:modelValue":t[0]||(t[0]=e=>m.selectedSet=e),"options-dense":"",dense:"",style:{width:"250px"}},null,8,["modelValue"]),(0,s.Wm)(w,{outlined:"",label:"Select monitored plots",options:m.monitoring_meta.plots,"stack-label":"",modelValue:m.selectedPlots,"onUpdate:modelValue":t[1]||(t[1]=e=>m.selectedPlots=e),multiple:"",clearable:"","options-dense":"",dense:"",style:{width:"250px"}},null,8,["options","modelValue"]),(0,s.Wm)(w,{outlined:"",label:"Select monitored sensors",options:m.monitoring_meta.sensors,"stack-label":"","option-label":"sensor",modelValue:m.selectedSensors,"onUpdate:modelValue":t[2]||(t[2]=e=>m.selectedSensors=e),multiple:"",clearable:"","options-dense":"",dense:"",style:{width:"250px"}},null,8,["options","modelValue"])])),_:1}),(0,s.Wm)(E,{onClick:p.refresh,loading:m.dataLoading,icon:"refresh"},{default:(0,s.w5)((()=>[a])),_:1},8,["onClick","loading"]),(0,s.Wm)(G,{dense:"",columns:p.columns,rows:p.rows,"row-key":"plot","rows-per-page-options":[0],pagination:m.pagination,"hide-pagination":"","sort-method":p.customSort,"binary-state-sort":""},{body:(0,s.w5)((e=>[(0,s.Wm)(H,{props:e},{default:(0,s.w5)((()=>[(0,s.Wm)(g,{key:"plot",props:e},{default:(0,s.w5)((()=>[(0,s._)("b",null,(0,n.zw)(e.row.plot),1)])),_:2},1032,["props"]),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(p.sensorColumns,(t=>((0,s.wg)(),(0,s.j4)(g,{props:e,key:t.sensor,class:(0,n.C_)(p.cellClass(t,e.row)),title:e.row.plot+" "+t.sensor},{default:(0,s.w5)((()=>[t.number?((0,s.wg)(),(0,s.iD)("span",r,(0,n.zw)(-99999===e.row[t.sensor]?"":e.row[t.sensor].toFixed(2)),1)):((0,s.wg)(),(0,s.iD)("i",l,(0,n.zw)(0===e.row[t.sensorTimestamp]?"":e.row[t.sensor]),1))])),_:2},1032,["props","class","title"])))),128))])),_:2},1032,["props"])])),_:1},8,["columns","rows","pagination","sort-method"]),void 0===m.data?((0,s.wg)(),(0,s.iD)("div",i," Click refresh button to load data! ")):(0,s.kq)("",!0)])),_:1})])),_:1})])),_:1})}o(702),o(3269);var m=o(3100),p=o(3828);const c={components:{pagesToolbar:p.Z},data(){return{data:void 0,dataLoading:!1,pagination:{page:1,rowsPerPage:0},monitoring_meta:{plots:["HEG01","HEG02","HEG03","HEG04","HEG05","HEG06","HEG07","HEG08","HEG09","HEG10","HEG11","HEG12","HEG13","HEG14","HEG15","HEG16","HEG17","HEG18","HEG19","HEG20","HEG21","HEG22","HEG23","HEG24","HEG25","HEG26","HEG27","HEG28","HEG29","HEG30","HEG31","HEG32","HEG33","HEG34","HEG35","HEG36","HEG37","HEG38","HEG39","HEG40","HEG41","HEG42","HEG43","HEG44","HEG45","HEG46","HEG47","HEG48","HEG49","HEG50"],sensors:[{sensor:"UB",ok:[12.2,14.9],warn:[11.9,14.9]},{sensor:"Ta_200",ok:[-20,35],warn:[-40,40]},{sensor:"Ta_10",ok:[-20,35],warn:[-40,40]},{sensor:"Ts_05",ok:[-20,35],warn:[-40,40]},{sensor:"Ts_10",ok:[-20,35],warn:[-40,40]},{sensor:"Ts_20",ok:[-20,35],warn:[-40,40]},{sensor:"Ts_50",ok:[-20,35],warn:[-40,40]},{sensor:"SM_10",ok:[1,65],warn:[0,70]},{sensor:"SM_20",ok:[1,65],warn:[0,70]},{sensor:"SM_30",ok:[1,65],warn:[0,70]},{sensor:"rH_200",ok:[15,100],warn:[0,100]},{sensor:"LWDR_300",ok:[0,1e3],warn:[0,1500]},{sensor:"LWUR_300",ok:[0,1e3],warn:[0,1500]},{sensor:"SWDR_300",ok:[0,1e3],warn:[0,1500]},{sensor:"SWUR_300",ok:[0,1e3],warn:[0,1500]}]},selectedSet:"Exploratories HEG",selectedSensors:void 0,selectedPlots:void 0}},computed:{...(0,m.Se)({apiGET:"apiGET"}),columns(){let e=[{name:"plot",field:"plot",label:"Plot",sortable:!0}];return void 0!==this.monitoring_meta&&void 0!==this.data&&this.data.sensors.forEach((t=>{const o=this.monitoring_meta.sensors.find((e=>e.sensor===t));console.log(o);const s=o.sensor+".datetime";e.push({name:s,field:s,label:"datetime",sortable:!0}),e.push({name:o.sensor,field:o.sensor,label:o.sensor,sortable:!0})})),e},columnMap(){let e={plot:{sortType:"text"}};return void 0!==this.monitoring_meta&&this.monitoring_meta.sensors.forEach((t=>{const o=t.sensor+".datetime";e[t.sensor]={sortType:"number"},e[o]={sortType:"text"}})),e},sensorColumns(){let e=[];return void 0!==this.monitoring_meta&&this.monitoring_meta.sensors.forEach((t=>{const o=t.sensor+".datetime",s=t.sensor+".timestamp";e.push({sensor:o,datetime:!0,number:!1,sensorTimestamp:s}),e.push({sensor:t.sensor,datetime:!1,number:!0,ok:t.ok,warn:t.warn,sensorTimestamp:s})})),e},rows(){if(void 0===this.data)return[];const e=this.data.sensors;let t=this.data.measurements.map((t=>{let o={plot:t.plot};const s=t.datetime,n=t.value,a=t.timestamp;for(let r=0;r<e.length;r++){const t=e[r],l=t+".datetime",i=t+".timestamp";o[l]=s[r],o[t]=n[r],o[i]=a[r]}return o}));return t},timestampNow(){return void 0===this.data?0:this.data.timestamp}},methods:{async refresh(){try{const e=new URLSearchParams;this.selectedPlots?this.selectedPlots.forEach((t=>e.append("plot",t))):this.monitoring_meta.plots.forEach((t=>e.append("plot",t))),this.selectedSensors?this.selectedSensors.forEach((t=>e.append("sensor",t.sensor))):this.monitoring_meta.sensors.forEach((t=>e.append("sensor",t.sensor))),this.dataLoading=!0;const t=await this.apiGET(["tsdb","monitoring"],{params:e});this.data=t.data}catch(e){this.data=void 0,console.log(e),this.$q.notify({message:"Error loading data.",type:"negative"})}finally{this.dataLoading=!1}},cellClass(e,t){const o=t[e.sensor],s=t[e.sensorTimestamp],n=this.timestampNow-s,a=n>1e5||n<-1440,r=n>2e5||n<-2880;return console.log(e.sensorTimestamp),console.log(n),e.number?-99999===o?"":e.ok?e.ok[0]<=o&&o<=e.ok[1]?a?"sensor-ok-outdated":"sensor-ok":e.warn&&e.warn[0]<=o&&o<=e.warn[1]?a?"sensor-warn-outdated":"sensor-warn":a?"sensor-error-outdated":"sensor-error":e.warn?e.warn[0]<=o&&o<=e.warn[1]?a?"sensor-warn-outdated":"sensor-warn":a?"sensor-error-outdated":"sensor-error":a?"sensor-ok-outdated":"sensor-ok":e.datetime?a?r?"time-error":"time-warn":"time-ok":""},customSort(e,t,o){const s=[...e];if(t){const e=this.columnMap[t];let n;switch(e.sortType){case"number":n=o?(e,o)=>parseFloat(o[t])-parseFloat(e[t]):(e,o)=>parseFloat(e[t])-parseFloat(o[t]);break;default:n=o?(e,o)=>o[t]>e[t]?1:o[t]<e[t]?-1:0:(e,o)=>e[t]>o[t]?1:e[t]<o[t]?-1:0}void 0!==n&&s.sort(n)}return s}},watch:{},async mounted(){}};var u=o(1639),w=o(249),h=o(6602),E=o(2133),g=o(9885),H=o(1663),G=o(5959),k=o(4455),_=o(7580),f=o(9546),b=o(7220),v=o(9984),y=o.n(v);const T=(0,u.Z)(c,[["render",d],["__scopeId","data-v-af197610"]]),S=T;y()(c,"components",{QLayout:w.Z,QHeader:h.Z,QPageContainer:E.Z,QPage:g.Z,QToolbar:H.Z,QSelect:G.Z,QBtn:k.Z,QTable:_.Z,QTr:f.Z,QTd:b.Z})}}]);