"use strict";(globalThis["webpackChunkapp"]=globalThis["webpackChunkapp"]||[]).push([[656],{3904:(t,e,a)=>{a.d(e,{Z:()=>q});var l=a(9835),o=a(6970);const s=t=>((0,l.dD)("data-v-9fde52e0"),t=t(),(0,l.Cn)(),t),n={class:"text-h5"},i=s((()=>(0,l._)("div",null,null,-1)));function r(t,e,a,s,r,d){const u=(0,l.up)("pages-menu"),p=(0,l.up)("q-toolbar");return(0,l.wg)(),(0,l.j4)(p,{class:"title fit row wrap justify-between"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{active:a.active},null,8,["active"]),(0,l._)("div",n,(0,o.zw)(a.title),1),i])),_:1})}function d(t,e,a,s,n,i){const r=(0,l.up)("q-item-section"),d=(0,l.up)("q-item"),u=(0,l.up)("q-list"),p=(0,l.up)("q-menu"),c=(0,l.up)("q-btn");return(0,l.wg)(),(0,l.j4)(c,{color:"primary",round:"",icon:"menu"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{"transition-show":"scale","transition-hide":"scale"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{style:{"min-width":"100px"}},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.items,(t=>((0,l.wg)(),(0,l.j4)(d,{key:t.title,to:t.link,clickable:"",class:(0,o.C_)({activeitem:a.active===t.link})},{default:(0,l.w5)((()=>[(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(t.title),1)])),_:2},1024)])),_:2},1032,["to","class"])))),128))])),_:1})])),_:1})])),_:1})}const u={name:"pages-menu",props:["active"],data(){return{items:[{title:"Overview",link:"/overview"},{title:"Metadata",link:"/model"},{title:"Diagrams",link:"/diagram"},{title:"Monitoring",link:"/monitoring"},{title:"Plot status",link:"/plot_status"}]}},computed:{},methods:{},watch:{},async mounted(){}};var p=a(1639),c=a(4455),m=a(6362),w=a(3246),g=a(490),f=a(6749),h=a(9984),_=a.n(h);const k=(0,p.Z)(u,[["render",d],["__scopeId","data-v-8f29c848"]]),v=k;_()(u,"components",{QBtn:c.Z,QMenu:m.Z,QList:w.Z,QItem:g.Z,QItemSection:f.Z});const y={name:"pages-toolbar",props:["title","active"],components:{pagesMenu:v},data(){return{}},computed:{},methods:{},watch:{},async mounted(){}};var b=a(1663);const W=(0,p.Z)(y,[["render",r],["__scopeId","data-v-9fde52e0"]]),q=W;_()(y,"components",{QToolbar:b.Z})},656:(t,e,a)=>{a.r(e),a.d(e,{default:()=>H});var l=a(9835),o=a(6970);function s(t,e,a,s,n,i){const r=(0,l.up)("pages-toolbar"),d=(0,l.up)("q-header"),u=(0,l.up)("q-td"),p=(0,l.up)("q-table"),c=(0,l.up)("q-card"),m=(0,l.up)("q-page"),w=(0,l.up)("q-page-container"),g=(0,l.up)("plot-status-dialog"),f=(0,l.up)("q-layout");return(0,l.wg)(),(0,l.j4)(f,{view:"hHh LpR fFf"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{reveal:"",elevated:"",class:"bg-grey-7 text-grey-4"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{title:"Plot status",active:"/plot_status"})])),_:1}),(0,l.Wm)(w,{class:"row justify-center"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{padding:"",class:"column justify-center"},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{bordered:"",class:"overview-item"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{rows:n.rows,columns:n.columns,pagination:n.pagination,"hide-bottom":"",dense:"",loading:n.rowsLoading,"row-key":"plot","binary-state-sort":"",onRowClick:i.onRowClick,"table-header-class":"table-header"},{top:(0,l.w5)((()=>[(0,l.Uk)(" Select plot ")])),"body-cell-first_datetime":(0,l.w5)((t=>[(0,l.Wm)(u,{props:t},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(t.row.first_date)+" ",1),(0,l._)("span",null,(0,o.zw)(t.row.first_time),1)])),_:2},1032,["props"])])),"body-cell-last_datetime":(0,l.w5)((t=>[(0,l.Wm)(u,{props:t},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(t.row.last_date)+" ",1),(0,l._)("span",null,(0,o.zw)(t.row.last_time),1)])),_:2},1032,["props"])])),"body-cell-voltage":(0,l.w5)((t=>[(0,l.Wm)(u,{props:t},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(void 0===t.row.voltage?"-":t.row.voltage.toFixed(2)),1)])),_:2},1032,["props"])])),_:1},8,["rows","columns","pagination","loading","onRowClick"])])),_:1})])),_:1})])),_:1}),(0,l.Wm)(g,{ref:"plotStatusDialog",onChanged:i.refresh},null,8,["onChanged"])])),_:1})}a(9635),a(1254),a(1389);var n=a(3100),i=a(3904);const r={class:"info"},d={key:0},u={key:1},p={key:2},c={key:3},m={key:4};function w(t,e,a,s,n,i){const w=(0,l.up)("q-space"),g=(0,l.up)("q-tooltip"),f=(0,l.up)("q-btn"),h=(0,l.up)("q-bar"),_=(0,l.up)("q-linear-progress"),k=(0,l.up)("q-header"),v=(0,l.up)("q-item-section"),y=(0,l.up)("q-item"),b=(0,l.up)("q-icon"),W=(0,l.up)("q-input"),q=(0,l.up)("q-list"),Z=(0,l.up)("q-page-container"),Q=(0,l.up)("q-card-actions"),S=(0,l.up)("q-card"),C=(0,l.up)("q-footer"),T=(0,l.up)("q-layout"),x=(0,l.up)("q-dialog"),U=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.j4)(x,{modelValue:n.shown,"onUpdate:modelValue":e[3]||(e[3]=t=>n.shown=t),maximized:!0},{default:(0,l.w5)((()=>[(0,l.Wm)(T,{view:"hHh lpR fFf",class:"bg-grey-1"},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{elevated:"",class:"bg-grey-1 text-black"},{default:(0,l.w5)((()=>[(0,l.Wm)(h,null,{default:(0,l.w5)((()=>[(0,l.Uk)(" Status "),(0,l.Wm)(w),(0,l.Uk)(" "+(0,o.zw)(n.plot)+" ",1),(0,l.Wm)(w),(0,l.wy)(((0,l.wg)(),(0,l.j4)(f,{dense:"",flat:"",icon:"close"},{default:(0,l.w5)((()=>[(0,l.Wm)(g,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Close")])),_:1})])),_:1})),[[U]])])),_:1}),n.loading?((0,l.wg)(),(0,l.j4)(_,{key:0,indeterminate:""})):(0,l.kq)("",!0)])),_:1}),n.loading||n.error?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(Z,{key:0,class:"text-black"},{default:(0,l.w5)((()=>[(0,l.Wm)(q,null,{default:(0,l.w5)((()=>[(0,l.Wm)(y,null,{default:(0,l.w5)((()=>[(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l._)("span",r,[void 0!==n.row.first_date?((0,l.wg)(),(0,l.iD)("span",d,[(0,l.Uk)("Measurements from "),(0,l._)("span",null,(0,o.zw)(n.row.first_date),1),(0,l.Uk)(),(0,l._)("span",null,(0,o.zw)(n.row.first_time),1)])):(0,l.kq)("",!0),void 0!==n.row.first_date?((0,l.wg)(),(0,l.iD)("span",u,[(0,l.Uk)(" to "),(0,l._)("span",null,(0,o.zw)(n.row.last_date),1),(0,l.Uk)(),(0,l._)("span",null,(0,o.zw)(n.row.last_time),1)])):(0,l.kq)("",!0),void 0!==n.row.elapsed_days?((0,l.wg)(),(0,l.iD)("span",p,[(0,l.Uk)(" Elapsed days "),(0,l._)("span",null,(0,o.zw)(n.row.elapsed_days),1)])):(0,l.kq)("",!0),void 0!==n.row.voltage?((0,l.wg)(),(0,l.iD)("span",c,[(0,l.Uk)(" Latest voltage "),(0,l._)("span",null,(0,o.zw)(n.row.voltage),1)])):(0,l.kq)("",!0),void 0!==n.row.author?((0,l.wg)(),(0,l.iD)("span",m,[(0,l.Uk)(" Status author "),(0,l._)("span",null,(0,o.zw)(n.row.author),1),(0,l.Uk)(" date "),(0,l._)("span",null,(0,o.zw)(n.row.datetime),1)])):(0,l.kq)("",!0)])])),_:1})])),_:1}),(0,l.Wm)(y,null,{default:(0,l.w5)((()=>[(0,l.Wm)(v,{side:""},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{name:"info"})])),_:1}),(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(W,{outlined:"",modelValue:n.row.status,"onUpdate:modelValue":e[0]||(e[0]=t=>n.row.status=t),label:"Status","stack-label":"",dense:""},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(y,null,{default:(0,l.w5)((()=>[(0,l.Wm)(v,{side:""},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{name:"task"})])),_:1}),(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(W,{outlined:"",modelValue:n.row.tasks,"onUpdate:modelValue":e[1]||(e[1]=t=>n.row.tasks=t),label:"Tasks","stack-label":"",dense:""},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(y,null,{default:(0,l.w5)((()=>[(0,l.Wm)(v,{side:""},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{name:"text_snippet"})])),_:1}),(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(W,{outlined:"",modelValue:n.row.notes,"onUpdate:modelValue":e[2]||(e[2]=t=>n.row.notes=t),label:"Notes","stack-label":"",dense:"",type:"textarea"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1})),n.loading||n.error?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(C,{key:1,elevated:"",class:"bg-grey-1"},{default:(0,l.w5)((()=>[(0,l.Wm)(S,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Q,{align:"right"},{default:(0,l.w5)((()=>[(0,l.wy)((0,l.Wm)(f,{flat:"",label:"Cancel",color:"primary"},null,512),[[U]]),(0,l.Wm)(f,{flat:"",label:"Save",color:"primary",onClick:i.onSubmit,loading:n.submitting},null,8,["onClick","loading"])])),_:1})])),_:1})])),_:1}))])),_:1})])),_:1},8,["modelValue"])}const g={props:[],components:{},data(){return{shown:!1,plot:void 0,loading:!1,error:!1,submitting:!1,row:{}}},computed:{...(0,n.Se)({apiGET:"apiGET",apiPOST:"apiPOST"})},methods:{show(t){this.shown=!0,this.plot=t,this.refresh()},async refresh(){try{this.loading=!0;const t=new URLSearchParams;t.append("plot",this.plot),t.append("plot_status","");const e=await this.apiGET(["tsdb","status"],{params:t});let a=e.data;a.forEach((t=>{{const e=t.first_datetime.split("T");t.first_date=e[0],t.first_time=e[1]}{const e=t.last_datetime.split("T");t.last_date=e[0],t.last_time=e[1]}})),this.row=0===a.length?{}:a[0],this.row.plot!==this.plot&&(this.error=!0,this.plot=void 0,this.row={},this.$q.notify({message:"Error loading data.",type:"negative"}))}catch(t){this.error=!0,this.plot=void 0,this.rows=[],console.log(t),this.$q.notify({message:"Error loading data.",type:"negative"})}finally{this.loading=!1}},async onSubmit(){try{this.submitting=!0;const t=await this.apiPOST(["tsdb","status"],this.row);console.log(t),this.$emit("changed"),this.shown=!1}catch(t){console.log(t),this.$q.notify({message:"Error submitting data.",type:"negative"})}finally{this.submitting=!1}}},watch:{},async mounted(){}};var f=a(1639),h=a(2074),_=a(249),k=a(6602),v=a(4526),y=a(136),b=a(4455),W=a(6858),q=a(8289),Z=a(2133),Q=a(3246),S=a(490),C=a(6749),T=a(2857),x=a(6611),U=a(1378),z=a(4458),L=a(1821),M=a(2146),E=a(9984),P=a.n(E);const j=(0,f.Z)(g,[["render",w],["__scopeId","data-v-27c86a36"]]),D=j;P()(g,"components",{QDialog:h.Z,QLayout:_.Z,QHeader:k.Z,QBar:v.Z,QSpace:y.Z,QBtn:b.Z,QTooltip:W.Z,QLinearProgress:q.Z,QPageContainer:Z.Z,QList:Q.Z,QItem:S.Z,QItemSection:C.Z,QIcon:T.Z,QInput:x.Z,QFooter:U.Z,QCard:z.Z,QCardActions:L.Z}),P()(g,"directives",{ClosePopup:M.Z});const I={components:{pagesToolbar:i.Z,plotStatusDialog:D},data(){return{columns:[{name:"plot",field:"plot",label:"Plot",headerStyle:"text-align: center; border-right: 1px solid #c6c6c6;",align:"center",sortable:!0,classes:"plot"},{name:"first_datetime",field:"first_datetime",label:"Earliest data",headerStyle:"text-align: center;",align:"center",sortable:!0},{name:"last_datetime",field:"last_datetime",label:"Latest data",headerStyle:"text-align: center;",align:"center",sortable:!0},{name:"elapsed_days",field:"elapsed_days",label:"Elapsed days",headerStyle:"text-align: center;",align:"right",sortable:!0,classes:t=>this.elapsedClass(t.elapsed_days)},{name:"voltage",field:"voltage",label:"Latest voltage",headerStyle:"text-align: center;",align:"right",sortable:!0,classes:this.voltageClass},{name:"status",field:"status",label:"Status",headerStyle:"text-align: center;",align:"left",sortable:!0,style:"max-width: 150px; overflow: hidden; text-overflow: ellipsis; background-color: rgba(0, 0, 255, 0.02);"},{name:"tasks",field:"tasks",label:"Tasks",headerStyle:"text-align: center;",align:"left",sortable:!0,style:"max-width: 300px; overflow: hidden; text-overflow: ellipsis; background-color: #fff;"}],pagination:{rowsPerPage:0,sortBy:"last_datetime"},rows:[],rowsLoading:!1}},computed:{...(0,n.Se)({apiGET:"apiGET"})},methods:{async refresh(){try{this.rowsLoading=!0;const t=new URLSearchParams;t.append("generalstation","HEG"),t.append("plot_status","");const e=await this.apiGET(["tsdb","status"],{params:t});let a=e.data;a.forEach((t=>{{const e=t.first_datetime.split("T");t.first_date=e[0],t.first_time=e[1]}{const e=t.last_datetime.split("T");t.last_date=e[0],t.last_time=e[1]}})),this.rows=a}catch(t){this.rows=[],console.log(t),this.$q.notify({message:"Error loading data.",type:"negative"})}finally{this.rowsLoading=!1}},elapsedClass(t){let e="timeMarkOneMonth";return e=t>365?"timeMarkLost":t>28?"timeMarkOneMonth":t>14?"timeMarkTwoWeeks":t>7?"timeMarkOneWeek":"timeMarkNow",e},voltageClass:function(t){const e=t.voltage;let a="voltageMarkNaN";return void 0!==e&&e>=0&&e<t.voltage_min_error&&(a=t.voltage_min_good<=e?"voltageMarkOK":t.voltage_min_watch<=e?"voltageMarkWARN":"voltageMarkCRITICAL"),a},onRowClick(t,e){console.log(e.plot),this.$refs.plotStatusDialog.show(e.plot)}},watch:{},async mounted(){this.refresh()}};var V=a(9885),R=a(6008),O=a(7220);const G=(0,f.Z)(I,[["render",s],["__scopeId","data-v-544af696"]]),H=G;P()(I,"components",{QLayout:_.Z,QHeader:k.Z,QPageContainer:Z.Z,QPage:V.Z,QCard:z.Z,QTable:R.Z,QTd:O.Z})}}]);